<!DOCTYPE html>
<html>
<head>
    <title>Inventory - Dokan</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .form-control { margin-bottom: 10px; padding: 8px; width: 200px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .btn-primary { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Inventory Management</h1>
    <a href="/logout">Logout</a>

    <form action="{{ url_for('inventory') }}" method="POST" style="margin-bottom: 30px; border: 1px solid #ccc; padding: 20px;">
        <h3>{{ 'Edit Product' if edit_item else 'Add New Product' }}</h3>
        
        <input type="text" name="id" class="form-control" placeholder="Product ID" 
               value="{{ edit_item.id if edit_item else '' }}" required {{ 'readonly' if edit_item else '' }}>
               
        <input type="text" name="name" class="form-control" placeholder="Product Name" 
               value="{{ edit_item.name if edit_item else '' }}" required>
               
        <input type="text" name="category" class="form-control" placeholder="Category" 
               value="{{ edit_item.category if edit_item else '' }}" required>
        
        <input type="number" name="stock" class="form-control" placeholder="Stock" 
               value="{{ edit_item.stock if edit_item else '' }}" required min="0">
               
        <input type="number" name="price" class="form-control" placeholder="Price" 
               value="{{ edit_item.price if edit_item else '' }}" required min="0" step="0.01">
               
        <input type="date" name="expiry_date" class="form-control" 
               value="{{ edit_item.expiry_date if edit_item else '' }}">
               
        <input type="text" name="supplier" class="form-control" placeholder="Supplier" 
               value="{{ edit_item.supplier if edit_item else '' }}" required>
               
        <button type="submit" class="btn-primary">
            {{ 'Update Product' if edit_item else '+ Add Product' }}
        </button>
        
        {% if edit_item %}
            <a href="{{ url_for('inventory') }}" style="margin-left: 10px;">Cancel Edit</a>
        {% endif %}
    </form>

    <hr>

    <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="ðŸ” Search products..." 
           style="width: 100%; padding: 10px; margin-bottom: 10px;">

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Category</th>
                <th>Stock</th>
                <th>Price</th>
                <th>Expiry</th>
                <th>Supplier</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td>{{ item.id }}</td>
                <td>{{ item.name }}</td>
                <td>{{ item.category }}</td>
                <td>{{ item.stock }}</td>
                <td>{{ item.price }}</td>
                <td>{{ item.expiry_date }}</td>
                <td>{{ item.supplier }}</td>
                <td>
                    <a href="{{ url_for('edit_product', item_id=item.id) }}" style="color: blue; margin-right: 10px;">Edit</a>
                    
                    <a href="{{ url_for('delete_item', item_id=item.id) }}" 
                       onclick="return confirm('Are you sure you want to delete this item?');"
                       style="color: red;">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
    function searchTable() {
        var input = document.getElementById("searchInput");
        var filter = input.value.toUpperCase();
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");

        for (var i = 1; i < tr.length; i++) {
            var tdName = tr[i].getElementsByTagName("td")[1];
            var tdCat = tr[i].getElementsByTagName("td")[2];
            if (tdName || tdCat) {
                var txtValue = (tdName.textContent || tdName.innerText) + (tdCat.textContent || tdCat.innerText);
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }
    </script>
</body>
</html>